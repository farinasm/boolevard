{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Processing Boolean Models from Cell Collective"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "<h1 style=\"margin-bottom: 50px;\" id=\"section-0\"><b>BooLEVARD Tutorials</b></h1>\n",
    "<h5 style=\"margin-bottom: 2px; margin-top: 0px;\" id=\"section-0.1\">\n",
    "    <b><span style=\"color: green;\">[Tutorial 4]</span> Processing Boolean Models from Cell Collective</b>\n",
    "</h5>\n",
    "<p>\n",
    "In this tutorial, we present a workflow for processing Boolean models available in Cell Collective using BooLEVARD. The pipeline involves the following steps:\n",
    "\n",
    "1. **Importing** a model in *SBML-qual* format (Cell Collective default).\n",
    "2. **Converting** the model to *BoolNet* format (BooLEVARD's input).\n",
    "3. **Loading** the model into **BooLEVARD** to compute path-count-based transduction scores toward every non-input node within the model.\n",
    "4. **Extracting** stable state analysis results to determine the binary activation state (0 or 1) of the non-input nodes within the model.\n",
    "\n",
    "In addition to the transduction scores and stable states, we provide metadata for each example, including:\n",
    "- Total numbber of nodes,\n",
    "- Number of computed *stable states*,\n",
    "- Total count of *activating and inhibitory paths*.\n",
    "- And the *runtime* required for each computation step.\n",
    "\n",
    "We apply this workflow to six publicly available Boolean models from Cell Collective:\n",
    "\n",
    "- **T Cell Receptor Signaling** <a href=\"#section-1\">[visit]</a><br>\n",
    "- **Guard Cell Abscisic Acid Signaling**<a href=\"#section-2\"> [visit]</a><br>\n",
    "- **T-LGL Survival Network**<a href=\"#section-3\"> [visit]</a><br>\n",
    "- **HGF Signaling in Keratinocytes**<a href=\"#section-4\"> [visit]</a><br>\n",
    "- **Bortezomib Responses in U266 Human Myeloma Cells**<a href=\"#section-5\"> [visit]</a><br>\n",
    "- **MAPK Cancer Cell Fate Network**<a href=\"#section-6\"> [visit]</a><br>\n",
    "- **IL-1 Signaling**<a href=\"#section-7\"> [visit]</a><br>\n",
    "- **IL-6 Signaling**<a href=\"#section-8\"> [visit]</a><br>\n",
    "- **Tumor Cell Invasion**<a href=\"#section-9\"> [visit]</a><br>\n",
    "\n",
    "This use case illustrates how mechanistic information encoded in the Boolean equations (captured by transduction path counts) can be systematically compared with the emergent behavior of the system derived from its stable states."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 158,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<script type=\"text/javascript\" id=\"colomoto-setup-9628083\" class=\"to-be-removed\">\n",
       "        if (typeof Jupyter != 'undefined') {\n",
       "            \n",
       "    var biolqm_jsapi = { action_upload_model: function() {\n",
       "        var cell = Jupyter.notebook.get_selected_cell();\n",
       "        cell.set_text('lqm = '+biolqm_jsapi.module_alias+'.upload()');\n",
       "        cell.focus_editor();\n",
       "    } };\n",
       "    colomoto_extension(Jupyter, \"colomoto-setup-9628083\", \"biolqm\", {\"name\": \"bioLQM\", \"sub-menu\": [{\"name\": \"Upload model\", \"snippet\": [\"lqm = biolqm.upload()\"]}, {\"name\": \"Load model\", \"snippet\": [\"lqm = biolqm.load(\\\"model.sbml\\\")\"]}, \"---\", {\"name\": \"Export to file\", \"sub-menu\": [{\"name\": \"SBML-qual v1.0 (.sbml)\", \"snippet\": [\"biolqm.save(lqm, \\\"mymodel.sbml\\\", \\\"sbml\\\")\"]}, \"Functions formats\", {\"name\": \"BoolNet (.bnet)\", \"snippet\": [\"biolqm.save(lqm, \\\"mymodel.bnet\\\", \\\"bnet\\\")\"]}, {\"name\": \"BooleanNet (.booleannet)\", \"snippet\": [\"biolqm.save(lqm, \\\"mymodel.booleannet\\\", \\\"booleannet\\\")\"]}, {\"name\": \"BoolSim (.boolsim)\", \"snippet\": [\"biolqm.save(lqm, \\\"mymodel.boolsim\\\", \\\"boolsim\\\")\"]}, {\"name\": \"Raw Boolean functions (.boolfunctions)\", \"snippet\": [\"biolqm.save(lqm, \\\"mymodel.boolfunctions\\\", \\\"boolfunctions\\\")\"]}, {\"name\": \"Truth table (.tt)\", \"snippet\": [\"biolqm.save(lqm, \\\"mymodel.tt\\\", \\\"tt\\\")\"]}, \"Petri net formats\", {\"name\": \"APNN (.apnn)\", \"snippet\": [\"biolqm.save(lqm, \\\"mymodel.apnn\\\", \\\"apnn\\\")\"]}, {\"name\": \"INA (.ina)\", \"snippet\": [\"biolqm.save(lqm, \\\"mymodel.ina\\\", \\\"ina\\\")\"]}, {\"name\": \"PNML (.pnml)\", \"snippet\": [\"biolqm.save(lqm, \\\"mymodel.pnml\\\", \\\"pnml\\\")\"]}, \"Dedicated formats\", {\"name\": \"GINML (.ginml)\", \"snippet\": [\"biolqm.save(lqm, \\\"mymodel.ginml\\\", \\\"ginml\\\")\"]}, {\"name\": \"GNA non-xml (.gna)\", \"snippet\": [\"biolqm.save(lqm, \\\"mymodel.gna\\\", \\\"gna\\\")\"]}, {\"name\": \"MaBoSS (.bnd)\", \"snippet\": [\"biolqm.save(lqm, \\\"mymodel.bnd\\\", \\\"bnd\\\")\"]}, {\"name\": \"Pint (.an)\", \"snippet\": [\"biolqm.save(lqm, \\\"mymodel.an\\\", \\\"an\\\")\"]}]}, {\"name\": \"Convert to tool\", \"sub-menu\": [{\"name\": \"GINsim\", \"snippet\": [\"lrg = biolqm.to_ginsim(lqm)\"]}, {\"name\": \"MaBoSS\", \"snippet\": [\"masim = biolqm.to_maboss(lqm)\"]}, {\"name\": \"Pint\", \"snippet\": [\"an = biolqm.to_pint(lqm)\"]}]}, \"---\", {\"name\": \"Compute fixpoints\", \"snippet\": [\"fps = biolqm.fixpoints(lqm)\"]}, {\"name\": \"Compute trap spaces\", \"snippet\": [\"traps = biolqm.trapspace(lqm)\"]}, \"---\", {\"name\": \"Model modifications\", \"sub-menu\": [{\"name\": \"Perturbation\", \"snippet\": [\"lqm_mod = biolqm.perturbation(lqm, \\\"node%0\\\")\"]}, {\"name\": \"Booleanization\", \"snippet\": [\"lqm_bool = biolqm.booleanize(lqm)\"]}, {\"name\": \"Reduction\", \"snippet\": [\"lqm_red = biolqm.reduce(lqm, \\\"fixed,output,duplicate\\\")\"]}, {\"name\": \"Reversal\", \"snippet\": [\"lqm_rev = biolqm.reverse(lqm)\"]}, {\"name\": \"Sanitize\", \"snippet\": [\"lqm_san = biolqm.sanitize(lqm)\"]}]}, \"---\", {\"name\": \"Documentation\", \"external-link\": \"http://ginsim.naldi.info/biolqm/site/doc/index.html\"}]}, [{\"name\": \"upload\", \"setup\": {\"icon\": \"fa-upload\", \"help\": \"Upload model\", \"handler\": \"action_upload_model\"}}], biolqm_jsapi);\n",
       "     }</script><style type=\"text/css\">\n",
       "    #biolqm_menu {\n",
       "        color: #00007f;\n",
       "        background-color: white;\n",
       "    }\n",
       "    \n",
       "    div#biolqm-toolbar:before {\n",
       "        content: \"bioLQM\";\n",
       "        float: left;\n",
       "        margin-left: 1em;\n",
       "        margin-right: 1em;\n",
       "        margin-top: 0.2em;\n",
       "    }\n",
       "    div#biolqm-toolbar,\n",
       "    div#biolqm-toolbar button {\n",
       "        color: #00007f;\n",
       "    }\n",
       "    </style>"
      ],
      "text/plain": [
       "<IPython.core.display.HTML object>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "data": {
      "text/html": [
       "<script type=\"text/javascript\" id=\"colomoto-setup-5145783\" class=\"to-be-removed\">\n",
       "        if (typeof Jupyter != 'undefined') {\n",
       "            \n",
       "    var ginsim_jsapi = { action_upload_model: function() {\n",
       "        var cell = Jupyter.notebook.get_selected_cell();\n",
       "        cell.set_text('lrg = '+ginsim_jsapi.module_alias+'.upload()');\n",
       "        cell.focus_editor();\n",
       "    } };\n",
       "    colomoto_extension(Jupyter, \"colomoto-setup-5145783\", \"ginsim\", {\"name\": \"GINsim\", \"sub-menu\": [{\"name\": \"Upload model\", \"snippet\": [\"lrg = ginsim.upload()\"]}, {\"name\": \"Load model\", \"snippet\": [\"lrg = ginsim.load(\\\"model.zginml\\\")\"]}, \"---\", {\"name\": \"Export to file\", \"sub-menu\": [{\"name\": \"MaBoSS (.bnd, .cfg)\", \"snippet\": [\"ginsim.service(\\\"maboss\\\").export(lrg, \\\"mymodel.bnd\\\")\"]}]}, {\"name\": \"Convert to tool\", \"sub-menu\": [{\"name\": \"bioLQM\", \"snippet\": [\"lqm = ginsim.to_biolqm(lrg)\"]}, {\"name\": \"MaBoSS\", \"snippet\": [\"masim = ginsim.to_maboss(lrg)\"]}, {\"name\": \"NuSMV\", \"snippet\": [\"smv = ginsim.to_nusmv(lrg)\"]}, {\"name\": \"Pint\", \"snippet\": [\"an = ginsim.to_pint(lrg)\"]}]}, \"---\", {\"name\": \" Display regulatory graph\", \"snippet\": [\"ginsim.show(lrg)\"]}]}, [{\"name\": \"upload\", \"setup\": {\"icon\": \"fa-upload\", \"help\": \"Upload model\", \"handler\": \"action_upload_model\"}}], ginsim_jsapi);\n",
       "     }</script><style type=\"text/css\">\n",
       "    #ginsim_menu {\n",
       "        color: blue;\n",
       "        background-color: white;\n",
       "    }\n",
       "    \n",
       "    div#ginsim-toolbar:before {\n",
       "        content: \"GINsim\";\n",
       "        float: left;\n",
       "        margin-left: 1em;\n",
       "        margin-right: 1em;\n",
       "        margin-top: 0.2em;\n",
       "    }\n",
       "    div#ginsim-toolbar,\n",
       "    div#ginsim-toolbar button {\n",
       "        color: blue;\n",
       "    }\n",
       "    </style>"
      ],
      "text/plain": [
       "<IPython.core.display.HTML object>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/home/marco/.local/lib/python3.11/site-packages/matplotlib/projections/__init__.py:63: UserWarning: Unable to import Axes3D. This may be due to multiple versions of Matplotlib being installed (e.g. as a system package and as a pip package). As a result, the 3D projection is not available.\n",
      "  warnings.warn(\"Unable to import Axes3D. This may be due to multiple versions of \"\n"
     ]
    }
   ],
   "source": [
    "import biolqm\n",
    "import tempfile\n",
    "import time\n",
    "import re\n",
    "import mpbn\n",
    "import contextlib\n",
    "import io\n",
    "import sys\n",
    "import xml.etree.ElementTree as ET\n",
    "import boolevard as blv\n",
    "import pandas as pd\n",
    "import seaborn as sb\n",
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "from PyComplexHeatmap import * \n",
    "from matplotlib.colors import ListedColormap, LinearSegmentedColormap\n",
    "from scipy.cluster.hierarchy import linkage, leaves_list\n",
    "from sklearn.metrics import r2_score\n",
    "from sklearn.linear_model import LinearRegression\n",
    "from matplotlib.ticker import LogLocator, NullFormatter"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Below we define the functions that will be used to convert the SBML models from Cell Collective into BoolNet format, generate a heatmap that compares stable state results with BooLEVARD's output (path counts), and a dataframe storing some metadata, including simulation times, number of stable states, and number of counted paths."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 159,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Extract qualitative species IDs and names from SBML-qual file\n",
    "def extract_qualids(sbml_file):\n",
    "    ns = {\"qual\": \"http://www.sbml.org/sbml/level3/version1/qual/version1\"}\n",
    "    tree = ET.parse(sbml_file)\n",
    "    root = tree.getroot()\n",
    "    id2name = {}\n",
    "    for q in root.findall(\".//qual:qualitativeSpecies\", ns):\n",
    "        qid = q.attrib.get(\"{http://www.sbml.org/sbml/level3/version1/qual/version1}id\")\n",
    "        name = q.attrib.get(\"{http://www.sbml.org/sbml/level3/version1/qual/version1}name\", qid)\n",
    "        if qid and name:\n",
    "            id2name[qid] = name\n",
    "    return id2name\n",
    "\n",
    "# Convert SBML-qual model to bnet format\n",
    "def sbml2bnet(sbml_file, output_file):\n",
    "    try:\n",
    "        model = biolqm.load(sbml_file)\n",
    "        id2name = extract_qualids(sbml_file)\n",
    "        with tempfile.NamedTemporaryFile(\"w+\", delete=False, suffix=\".bnet\") as f:\n",
    "            biolqm.save(model, f.name, \"bnet\")\n",
    "            f.seek(0)\n",
    "            lines = f.readlines()\n",
    "        new_lines = []\n",
    "        id_pattern = re.compile(r'\\b({})\\b'.format('|'.join(map(re.escape, id2name.keys()))))\n",
    "        for line in lines:\n",
    "            if line.startswith(\"#\") or \",\" not in line:\n",
    "                new_lines.append(line)\n",
    "                continue\n",
    "            target, expr = map(str.strip, line.split(\",\", 1))\n",
    "            target = id2name.get(target, target).replace(\",\", \"_\").replace(\"/\", \"_\").replace(\"+\", \"\").replace(\"-\", \"__\").replace(\"(\", \"\").replace(\")\", \"\")\n",
    "            expr = id_pattern.sub(lambda m: id2name[m.group(0)], expr)\n",
    "            expr = expr.replace(\"&\", \" & \").replace(\"/\", \"_\").replace(\",\", \"_\").replace(\"+\", \"\").replace(\"-\", \"__\").replace(\"(\", \"\").replace(\")\", \"\")\n",
    "            new_lines.append(f\"{target}, {expr}\\n\")\n",
    "        with open(output_file, \"w\") as out:\n",
    "            out.writelines(new_lines)\n",
    "        print(f\"✅ SBML-qual model successfully converted to bnet: {output_file}\")\n",
    "    except Exception as e:\n",
    "        print(f\"❌ Error: {e}\")\n",
    "\n",
    "# Get simulation times\n",
    "def simmulation_summary(model, pc):\n",
    "    n_paths = np.abs(pc).sum()\n",
    "    n_nodes = len(model.Nodes)\n",
    "    n_inputs = len(model.Info.index[model.Info.index == model.Info[\"DNF\"].apply(str)])\n",
    "    n_stable_states = len(pc)\n",
    "    avg_stime_ss = sim_time / n_stable_states\n",
    "    avg_stime_node = sim_time / n_stable_states / n_nodes\n",
    "    avg_stime_path = sim_time / n_paths\n",
    "    sum = pd.DataFrame([{\n",
    "        \"Simulation time (s)\": sim_time,\n",
    "        \"Stable states\": n_stable_states,\n",
    "        \"Nodes\": n_nodes,\n",
    "        \"Edges\": edges,\n",
    "        \"Inputs\": n_inputs,\n",
    "        \"Paths\": n_paths,\n",
    "        \"Avg time / state (s)\": avg_stime_ss,\n",
    "        \"Avg time / node (s)\": avg_stime_node,\n",
    "        \"Avg time / path (s)\": avg_stime_path\n",
    "    }])\n",
    "    return sum\n",
    "\n",
    "# Perform analysis using BooLEVARD\n",
    "def Report(model, paths, base = 4):\n",
    "    def log_signed(x, base):\n",
    "        return np.sign(x) * np.log1p(np.abs(x)) / np.log(base)\n",
    "    inputs = model.Info.index[model.Info.index == model.Info[\"DNF\"].apply(str)]\n",
    "    # Transduction:\n",
    "    paths_sum = pd.DataFrame(paths)\n",
    "    paths_sum.columns = nodes\n",
    "    paths_sum = paths_sum.loc[:, ~paths_sum.columns.isin(inputs)]\n",
    "    paths_sum = log_signed(paths_sum, base)\n",
    "    # Local states:\n",
    "    ls_info = model.Info.loc[nodes, model.Info.columns[:-2]].transpose()\n",
    "    ls_info = ls_info.loc[:, ~ls_info.columns.isin(inputs)]\n",
    "    ls_info.index = paths_sum.index\n",
    "    ### Plot heatmap ###\n",
    "    row_linkage = linkage(paths_sum.values, method=\"average\", metric=\"euclidean\")\n",
    "    col_linkage = linkage(paths_sum.values.T, method=\"average\", metric=\"euclidean\")\n",
    "    row_order = leaves_list(row_linkage)\n",
    "    col_order = leaves_list(col_linkage)\n",
    "    row_labels = paths_sum.index[row_order]\n",
    "    col_labels = paths_sum.columns[col_order]\n",
    "    paths_sum = paths_sum.loc[row_labels, col_labels]\n",
    "    ls_info = ls_info.loc[row_labels, col_labels]\n",
    "\n",
    "    colors_row_ha = {input_name: {\"0\": \"#eeeeee\", \"1\": \"#212121\"} for input_name in inputs}\n",
    "    # Annotations\n",
    "    annot_ls = pd.DataFrame([\"Local State\"]*(len(nodes)-len(inputs)), columns = [\"Score\"])\n",
    "    annot_paths = pd.DataFrame([\"Path Count\"]*(len(nodes)-len(inputs)), columns = [\"Score\"])\n",
    "    annot_inputs = model.Info.loc[inputs, model.Info.columns[:-2]].transpose().astype(str)\n",
    "    annot_inputs.index = paths_sum.index\n",
    "    row_ha_inputs = HeatmapAnnotation(df = annot_inputs, colors = colors_row_ha, plot = False, legend = False, axis = 0, label_kws = dict(size = 9), label_side = \"bottom\", wgap = 0.01, plot_kws = dict(linewidth = 0.001, linecolor = \"white\", linestyle = \":\"), legend_width=90) # Annotation for inputs\n",
    "    # - Subheatmap 1: Local States\n",
    "    cmap_ls = ListedColormap([\"#eeeeee\", \"#212121\"])\n",
    "    hmap_ls = ClusterMapPlotter(\n",
    "        ls_info.astype(int),\n",
    "        row_cluster = False, col_cluster = False,\n",
    "        show_rownames = True, show_colnames = True,\n",
    "        cmap = cmap_ls, linewidths = 0.001, linecolor = \"white\",\n",
    "        plot = False,\n",
    "        plot_legend = True, label = \"Local States\",\n",
    "        left_annotation = row_ha_inputs,\n",
    "        xlabel = \"Local States\",\n",
    "        xlabel_kws=dict(color='black',fontsize = 10,labelpad=7, x = 1, ha = \"center\"),\n",
    "        xticklabels_kws=dict(size=1),\n",
    "        xlabel_side='top'\n",
    "    )\n",
    "    # - Subheatmap 2: Path Count\n",
    "    cmap_paths = LinearSegmentedColormap.from_list(\"custom_diverging\", [\"#696bd4\", \"#FFFFFF\", \"#e55451\"], N = 256)\n",
    "    vmax_paths = np.max(np.abs(paths_sum.values))\n",
    "    hmap_paths = ClusterMapPlotter(\n",
    "        paths_sum,\n",
    "        row_cluster = False, col_cluster = False,\n",
    "        show_rownames = True, show_colnames = True,\n",
    "        left_annotation = row_ha_inputs,\n",
    "        cmap = cmap_paths, vmin = -vmax_paths, vmax = vmax_paths,\n",
    "        linewidths = 0.001, linecolor = \"white\",\n",
    "        plot = False,\n",
    "        plot_legend = True, label = \"Log4PC\",\n",
    "        xlabel = \"Log4-PathCounts\",\n",
    "        xlabel_kws=dict(color='black',fontsize=10,labelpad=7, x = 1, ha = \"center\"),\n",
    "        xlabel_side='top'\n",
    "    )\n",
    "    return[hmap_ls, hmap_paths]"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We set the environment to run the analysis across the models:\n",
    "- sbml_dir holding the models from Cell Collective.\n",
    "- bnet_dir storing the models in bnet format.\n",
    "- models_repo including the model names"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 160,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Conversion from SBML to BoolNet\n",
    "\n",
    "# BoolNet and SBML directories\n",
    "sbml_dir = \"models/sbml/\"\n",
    "bnet_dir = \"models/bnet/\"\n",
    "\n",
    "# Models #\n",
    "models_repo = [\n",
    "    \"T Cell Receptor Signaling (SBML)\",\n",
    "    \"Guard Cell Abscisic Acid Signaling (SBML)\",\n",
    "    \"T-LGL Survival Network 2011 (SBML)\",\n",
    "    \"HGF Signaling in Keratinocytes (SBML)\",\n",
    "    \"_Bortezomib Responses in U266 Human Myeloma Cells (SBML)\",\n",
    "    \"MAPK Cancer Cell Fate Network (SBML)\",\n",
    "    \"IL-1 Signaling (SBML)\",\n",
    "    \"IL-6 Signalling (SBML)\",\n",
    "    \"Tumour Cell Invasion and Migration (SBML)\"\n",
    "]"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "<h4 style=\"margin-top: 0px; margin-bottom: 2px;\"><b>Generate reports</b></h4>\n",
    "<h5 style=\"margin-top: 20px; margin-bottom: 2px;\" id=\"section-1\"><b>1.- T Cell Receptor Signaling</b><a href=\"#section-0\" style=\"font-size: 12px;\"> [back]</a></h5>\n",
    "\n",
    "<p>\n",
    "This model represents the activation of primary T lymphocytes, key regulators of the adaptive immune response. Unlike many existing models, which are often based on data from transformed T cell lines, this network was constructed integrating experimental findings specifically from non-transformed, primary T cells. The model captures key signaling events triggered by the engagement of the T Cell Receptor (TCR), CD4/CD8 co-receptors, and the co-stimulatory molecule CD28. Therefore, it enables the in silico exploration of T cell activation pathways and was used to uncover non-obvious signaling routes, such asthose involving CD28 and the kinase Fyn. \n",
    "</p>\n",
    "<p style=\"font-size:90%; color:gray;\">\n",
    "Saez-Rodriguez J, Simeoni L, Lindquist JA, Hemenway R, Bommhardt U, et al. (2007).  \n",
    "<i>A Logical Model Provides Insights into T Cell Receptor Signaling.</i>  \n",
    "PLOS Computational Biology 3(8): e163.  \n",
    "<a href=\"https://doi.org/10.1371/journal.pcbi.0030163\" target=\"_blank\">https://doi.org/10.1371/journal.pcbi.0030163</a>\n",
    "</p>"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Run analysis\n",
    "# Select model and convert SBML to BoolNet format\n",
    "model_name = models_repo[0]\n",
    "model_path = f\"{bnet_dir}{model_name}.bnet\"\n",
    "sbml2bnet((f\"{sbml_dir}{model_name}.sbml\"), (f\"{bnet_dir}{model_name}.bnet\"))\n",
    "# Load the BoolNet model, extract nodes and count paths\n",
    "model = blv.Load(model_path)\n",
    "nodes = model.Nodes\n",
    "edges = 158\n",
    "sys.stdout = open(os.devnull, 'w')\n",
    "start_time = time.time()\n",
    "pc = model.CountPaths(nodes, ss_wise = True)\n",
    "end_time = time.time()\n",
    "sys.stdout = sys.__stdout__\n",
    "sim_time = end_time - start_time\n",
    "ls, paths = Report(model, pc) # ls will contain stable state analysis results and paths will contain BooLEVARD's results\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Plot Report\n",
    "sim_sum1 = simmulation_summary(model, pc)\n",
    "display(sim_sum1.style.hide(axis = \"index\"))\n",
    "with contextlib.redirect_stdout(io.StringIO()):\n",
    "    plt.figure(figsize=(20, 4)); ls.plot()\n",
    "    plt.figure(figsize=(20, 4)); paths.plot()\n",
    "    plt.figure(figsize=(20, 1)); ls.plot_legends()\n",
    "    plt.figure(figsize=(20, 1)); paths.plot_legends()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "<div style=\"font-size:90%;\">\n",
    "\n",
    "**Figure 1.** Heatmaps showing the Boolean states (top) and the corresponding transduction path counts (bottom), calculated using BooLEVARD, for the stable states reached by the T Cell Receptor Signaling Boolean model. The Boolean activation states of the input nodes (*unknown_input3*, *tcrlig_input*, *cd28_input*, *unknown_input*, *lckr_input*, and *unknown_input*) that drive each stable state are shown to the left of both heatmaps (black = ON, white = OFF). Path counts are shown on a signed logarithmic scale (Log₄ of the number of activating or inhibitory paths). Red indicates a high number of activating paths toward a node; blue indicates inhibitory paths. Rows (stable states) and columns (nodes) have been clustered using Euclidean distance to highlight patterns across conditions and model components.\n",
    "\n",
    "</div>\n",
    "\n",
    "In the present and following examples, this visualization highlights the additional layer of information provided by **BooLEVARD** beyond the binary output of stable state analysis. Within each individual state, we can observe differences in the number of activating and inhibitory paths converging onto each node. These differences reflect both the topological positioning of each node (i.e. how upstream or downstream it is within the network) and the structural redundancy of the signaling routes that lead to its activation or repression. Moreover, by comparing across stable states, we can identify cases where different input combinations lead to identical binary states for certain nodes, yet exhibit marked differences in their transduction path profiles. Such cases may indicate nodes that are **functionally stable but topologically variable**, revealing hidden dependencies or alternative pathways that are not apparent from Boolean outputs alone. This enables a richer understanding of signal integration and robustness within the network."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "<h5 style=\"margin-top: 00px; margin-bottom: 2px;\" id=\"section-2\"><b>2.- Guard Cell Abscisic Acid</b><a href=\"#section-0\" style=\"font-size: 12px;\"> [back]</a><br></h5>\n",
    "<p>\n",
    "\n",
    "This model describes the signaling network underlying **ABA-induced stomatal closure** in plant guard cells. Stomata are microscopic pores on th leaf surface that regulate gas exchange, and their aperture is tightly controlled by a pair of guard cells. In response to drought, the hormone abscisic acid (ABA) promotes stomatal closure to minimize water loss. This complex physiological response involves a broad aarray of molecular components, including ion channels, secondary messengers, and cytoskeletal regulators. The model integrates more than 40 experimetally characterized components into a unified **signal transduction network** that captures the main regulatory interactions driving guard cell shrinkage and stomatal closure. It successfully reproduces known physiological and pathway-level respones to ABA.\n",
    "\n",
    "</p>\n",
    "<p style=\"font-size:90%; color:gray;\">\n",
    "Li S, Assmann SM, Albert R (2006).  \n",
    "<i>Predicting Essential Components of Signal Transduction Networks: A Dynamic Model of Guard Cell Abscisic Acid Signaling.</i>  \n",
    "PLOS Biology 4(10): e312.  \n",
    "<a href=\"https://doi.org/10.1371/journal.pbio.0040312\" target=\"_blank\">https://doi.org/10.1371/journal.pbio.0040312</a>\n",
    "</p>\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Run analysis\n",
    "# Select model and convert SBML to BoolNet format\n",
    "model_name = models_repo[1]\n",
    "model_path = f\"{bnet_dir}{model_name}.bnet\"\n",
    "sbml2bnet((f\"{sbml_dir}{model_name}.sbml\"), (f\"{bnet_dir}{model_name}.bnet\"))\n",
    "# Load the BoolNet model, extract nodes and count paths\n",
    "model = blv.Load(model_path)\n",
    "nodes = model.Nodes; edges = 78\n",
    "sys.stdout = open(os.devnull, 'w')\n",
    "start_time = time.time()\n",
    "pc = model.CountPaths(nodes, ss_wise = True)\n",
    "end_time = time.time()\n",
    "sys.stdout = sys.__stdout__\n",
    "sim_time = end_time - start_time\n",
    "ls, paths = Report(model, pc) # ls will contain stable state analysis results and paths will contain BooLEVARD's results"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Plot Report\n",
    "sim_sum2 = simmulation_summary(model, pc)\n",
    "display(sim_sum2.style.hide(axis = \"index\"))\n",
    "with contextlib.redirect_stdout(io.StringIO()):\n",
    "    plt.figure(figsize=(10, 2)); ls.plot()\n",
    "    plt.figure(figsize=(10, 2)); paths.plot()\n",
    "    plt.figure(figsize=(20, 1)); ls.plot_legends()\n",
    "    plt.figure(figsize=(20, 1)); paths.plot_legends()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "<div style=\"font-size:90%;\">\n",
    "\n",
    "**Figure 2.** Heatmaps showing the Boolean states (top) and the corresponding transduction path counts (bottom), calculated using BooLEVARD, for the stable states reached by the Guard Cell Ascibic Acid Boolean model. The Boolean activation states of the input nodes (*ABA*, *ABH1*, *GCR1* and *ERA1*) that drive each stable state are shown to the left of both heatmaps (black = ON, white = OFF). Path counts are shown on a signed logarithmic scale (Log₄ of the number of activating or inhibitory paths). Red indicates a high number of activating paths toward a node; blue indicates inhibitory paths. Rows (stable states) and columns (nodes) have been clustered using Euclidean distance to highlight patterns across conditions and model components.\n",
    "\n",
    "</div>"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "<h5 style=\"margin-top: 00px; margin-bottom: 2px;\" id=\"section-3\"><b>3.- T-LGL Survival Network</b><a href=\"#section-0\" style=\"font-size: 12px;\"> [back]</a></h5>\n",
    "<p>\n",
    "\n",
    "This model represents the survival signaling network of **T cell large granular lymphocyte (T-LGL) leukemia**, a disease characterized by the clonal expansion of antigen-primed, cytotoxic T lymphocytes (CTL). The model integrates key signaling pathways involved in normal CTL activation and dysregulated survival signals observed in leukemic T-LGL cells. It includes not only molecular components like proteins, mRNAs, and small molecules, but also summary nodes that represent high-level cellular processes such as *Proliferation*, *Apoptosis*, and *Cytoskeleton signaling*. Thediscrete dynamic model provides a framework for identifying potential therapeutic targets in T-LGL leukemia and for exploring mechanisms of long-term CTL survival in both pathological and immunotherapeutic contexts.\n",
    "<p style=\"font-size:90%; color:gray;\">\n",
    "Zhang R, Shah MV, Yang J, Nyland SB, Liu X, Yun JK, Albert R, Loughran TP (2008).  \n",
    "<i>Network Model of Survival Signaling in Large Granular Lymphocyte Leukemia.</i>  \n",
    "Proceedings of the National Academy of Sciences 105(42): 16308–16313.  \n",
    "<a href=\"https://doi.org/10.1073/pnas.0806447105\" target=\"_blank\">https://doi.org/10.1073/pnas.0806447105</a>\n",
    "</p>"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Run analysis\n",
    "# Select model and convert SBML to BoolNet format\n",
    "model_name = models_repo[2]\n",
    "model_path = f\"{bnet_dir}{model_name}.bnet\"\n",
    "sbml2bnet((f\"{sbml_dir}{model_name}.sbml\"), (f\"{bnet_dir}{model_name}.bnet\"))\n",
    "# Load the BoolNet model, extract nodes and count paths\n",
    "model = blv.Load(model_path)\n",
    "nodes = model.Nodes; edges = 195\n",
    "sys.stdout = open(os.devnull, 'w')\n",
    "start_time = time.time()\n",
    "pc = model.CountPaths(nodes, ss_wise = True)\n",
    "end_time = time.time()\n",
    "sys.stdout = sys.__stdout__\n",
    "sim_time = end_time - start_time\n",
    "ls, paths = Report(model, pc) # ls will contain stable state analysis results and paths will contain BooLEVARD's results"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Plot Report\n",
    "sim_sum3 = simmulation_summary(model, pc)\n",
    "display(sim_sum3.style.hide(axis = \"index\"))\n",
    "with contextlib.redirect_stdout(io.StringIO()):\n",
    "    plt.figure(figsize=(10, 4)); ls.plot()\n",
    "    plt.figure(figsize=(10, 4)); paths.plot()\n",
    "    plt.figure(figsize=(20, 1)); ls.plot_legends()\n",
    "    plt.figure(figsize=(20, 1)); paths.plot_legends()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "<div style=\"font-size:90%;\">\n",
    "\n",
    "**Figure 3.** Heatmaps showing the Boolean states (top) and the corresponding transduction path counts (bottom), calculated using BooLEVARD, for the stable states reached by the T-LGL Survival Network Boolean model. The Boolean activation states of the input nodes (*CD45*, *TAX*, *Stimuli*, *PDGF*, *IL15*, *Stimuli2*) that drive each stable state are shown to the left of both heatmaps (black = ON, white = OFF). Path counts are shown on a signed logarithmic scale (Log₄ of the number of activating or inhibitory paths). Red indicates a high number of activating paths toward a node; blue indicates inhibitory paths. Rows (stable states) and columns (nodes) have been clustered using Euclidean distance to highlight patterns across conditions and model components.\n",
    "\n",
    "</div>"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "<h5 style=\"margin-top: 00px; margin-bottom: 2px;\" id=\"section-4\"><b>4.- HGF Signaling in Keratinocytes</b><a href=\"#section-0\" style=\"font-size: 12px;\"> [back]</a></h5>\n",
    "<p>\n",
    "\n",
    "This model describes the molecular signaling events that govern **HGF-induced migration of human keratinocytes (NHK)**, a key process in wound healing and tissue regeneration. The model integrates multiple layers of regulation, including protein signaling, gene expression, and autocrine feedback loops, to capture the full progression from initial stimulation by hepatocyte growth factor (HGF) to the execution of the migratory phenotype. The networks focuses on the dynamics of MET receptor activation, followed by downstream MAPK/ERK and p38/JNK pathway activation, and later sustained by autocrine signals involving EGF receptor and urokinase-type plasminogen activator receptor. This layered activation captures the time-dependent orchestration of early signaling and late transcriptial responses necessary for sustained migration. To reproduce this dynamic behavior, the model incorporates two distinct time scales:\n",
    "- A **rapid phase** (0-1h) covering immediate protein phosphorylation events.\n",
    "- A **delayed phase** (1-3h) encompassing transcriptional regulation and autocrine signaling.\n",
    "\n",
    "This hybrid Boolean framework bridges transcriptomic data with mechanistic signaling, offering a powerful tool to explore the temporal logic of wound healing and keratinocyte migration.\n",
    "<p style=\"font-size:90%; color:gray;\">\n",
    "Singh A, Nascimento JM, Kowar S, Busch H, Boerries M (2012).  \n",
    "<i>Boolean Approach to Signalling Pathway Modelling in HGF-Induced Keratinocyte Migration.</i>  \n",
    "Bioinformatics, 28(18): i495–i501.  \n",
    "<a href=\"https://doi.org/10.1093/bioinformatics/bts410\" target=\"_blank\">https://doi.org/10.1093/bioinformatics/bts410</a>\n",
    "</p>"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Run analysis\n",
    "# Select model and convert SBML to BoolNet format\n",
    "model_name = models_repo[3]\n",
    "model_path = f\"{bnet_dir}{model_name}.bnet\"\n",
    "sbml2bnet((f\"{sbml_dir}{model_name}.sbml\"), (f\"{bnet_dir}{model_name}.bnet\"))\n",
    "# Load the BoolNet model, extract nodes and count paths\n",
    "model = blv.Load(model_path)\n",
    "nodes = model.Nodes; edges = 103\n",
    "sys.stdout = open(os.devnull, 'w')\n",
    "start_time = time.time()\n",
    "pc = model.CountPaths(nodes, ss_wise = True)\n",
    "end_time = time.time()\n",
    "sys.stdout = sys.__stdout__\n",
    "sim_time = end_time - start_time\n",
    "ls, paths = Report(model, pc) # ls will contain stable state analysis results and paths will contain BooLEVARD's results"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Plot Report\n",
    "sim_sum4 = simmulation_summary(model, pc)\n",
    "display(sim_sum4.style.hide(axis = \"index\"))\n",
    "with contextlib.redirect_stdout(io.StringIO()):\n",
    "    plt.figure(figsize=(10, 5)); ls.plot()\n",
    "    plt.figure(figsize=(10, 5)); paths.plot()\n",
    "    plt.figure(figsize=(20, 1)); ls.plot_legends()\n",
    "    plt.figure(figsize=(20, 1)); paths.plot_legends()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "<div style=\"font-size:90%;\">\n",
    "\n",
    "**Figure 4.** Heatmaps showing the Boolean states (top) and the corresponding transduction path counts (bottom), calculated using BooLEVARD, for the stable states reached by the HGF Signaling in Kertinocytes Boolean model. The Boolean activation states of the input nodes (*DUSP1*, *HGF*, *PTEN*, *PAI_1*, *AKAP12*, *EGF*) that drive each stable state are shown to the left of both heatmaps (black = ON, white = OFF). Path counts are shown on a signed logarithmic scale (Log₄ of the number of activating or inhibitory paths). Red indicates a high number of activating paths toward a node; blue indicates inhibitory paths. Rows (stable states) and columns (nodes) have been clustered using Euclidean distance to highlight patterns across conditions and model components.\n",
    "\n",
    "</div>"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "<h5 style=\"margin-top: 00px; margin-bottom: 2px;\" id=\"section-5\"><b>5.- Bortezomib Responses in U266 Human Myeloma Cells</b><a href=\"#section-0\" style=\"font-size: 12px;\"> [back]</a></h5>\n",
    "<p>\n",
    "\n",
    "This model represents the signaling pathways regulating **cell survival and apoptosis in U266 multiple myeloma (MM) cells**, with a focus on understanding the cytotoxic effects of bortezomib, a proteasome inhibitor used as first-line therapy in MM. The network integrates major signaling axes such as NFkB, JAK/STAT, and Bcl-2 family proteins. The model illustrate how discrete logic-based models can be coupled with drug response dynamics to explore therapeutic mechanisms and rationale discrepancies between expected and observed outcomes.\n",
    "<p style=\"font-size:90%; color:gray;\">\n",
    "Chudasama VL, Ovacik MA, Abernethy DR, Mager DE (2015).  \n",
    "<i>Logic-Based and Cellular Pharmacodynamic Modeling of Bortezomib Responses in U266 Human Myeloma Cells.</i>  \n",
    "The Journal of Pharmacology and Experimental Therapeutics, 354(3): 448–458.  \n",
    "<a href=\"https://doi.org/10.1124/jpet.115.224766\" target=\"_blank\">https://doi.org/10.1124/jpet.115.224766</a>\n",
    "</p>"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Run analysis\n",
    "# Select model and convert SBML to BoolNet format\n",
    "model_name = models_repo[4]\n",
    "model_path = f\"{bnet_dir}{model_name}.bnet\"\n",
    "sbml2bnet((f\"{sbml_dir}{model_name}.sbml\"), (f\"{bnet_dir}{model_name}.bnet\"))\n",
    "# Load the BoolNet model, extract nodes and count paths\n",
    "model = blv.Load(model_path)\n",
    "nodes = model.Nodes; edges = 131\n",
    "sys.stdout = open(os.devnull, 'w')\n",
    "start_time = time.time()\n",
    "pc = model.CountPaths(nodes, ss_wise = True)\n",
    "end_time = time.time()\n",
    "sys.stdout = sys.__stdout__\n",
    "sim_time = end_time - start_time\n",
    "ls, paths = Report(model, pc) # ls will contain stable state analysis results and paths will contain BooLEVARD's results"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "#Plot Report\n",
    "sim_sum5 = simmulation_summary(model, pc)\n",
    "display(sim_sum5.style.hide(axis = \"index\"))\n",
    "with contextlib.redirect_stdout(io.StringIO()):\n",
    "    plt.figure(figsize=(15, 5)); ls.plot()\n",
    "    plt.figure(figsize=(15, 5)); paths.plot()\n",
    "    plt.figure(figsize=(20, 1)); ls.plot_legends()\n",
    "    plt.figure(figsize=(20, 1)); paths.plot_legends()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "<div style=\"font-size:90%;\">\n",
    "\n",
    "**Figure 5.** Heatmaps showing the Boolean states (top) and the corresponding transduction path counts (bottom), calculated using BooLEVARD, for the stable states reached by the Bortezomib Responses in U266 Human Myeloma Cells Boolean Model. The Boolean activation states of the input nodes (*SHP1*, *TNFAR*, *X*, *TNFA*, *Bort*) that drive each stable state are shown to the left of both heatmaps (black = ON, white = OFF). Path counts are shown on a signed logarithmic scale (Log₄ of the number of activating or inhibitory paths). Red indicates a high number of activating paths toward a node; blue indicates inhibitory paths. Rows (stable states) and columns (nodes) have been clustered using Euclidean distance to highlight patterns across conditions and model components.\n",
    "\n",
    "</div>"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "<h5 style=\"margin-top: 00px; margin-bottom: 2px;\" id=\"section-6\"><b>6.- MAPK Cancer Cell Fate Network</b><a href=\"#section-0\" style=\"font-size: 12px;\"> [back]</a></h5>\n",
    "<p>\n",
    "\n",
    "This model captures the complex dynamics of the **MAPK signaling network**, which regulates crucial cellular processes such as proliferation, differentiation, survival, and apoptosis. The network integrates multiple signaling branches relevant in cancer biology, where its desregulation is associated with tumor progression and therapy resistance. Focusing on urinary bladder cancer, the model incorporates key components and interactions derived from extensive literature curation, and was developed to explore how combinations of stimuli and perturbations influence cell fate decisions, providing mechanistic hypotheses to explain divergent cellular behaviors in response to oncogenic signals.\n",
    "<p style=\"font-size:90%; color:gray;\">\n",
    "Grieco L, Calzone L, Bernard-Pierrot I, Radvanyi F, Kahn-Perlès B, et al. (2013).  \n",
    "<i>Integrative Modelling of the Influence of MAPK Network on Cancer Cell Fate Decision.</i>  \n",
    "PLOS Computational Biology 9(10): e1003286.  \n",
    "<a href=\"https://doi.org/10.1371/journal.pcbi.1003286\" target=\"_blank\">https://doi.org/10.1371/journal.pcbi.1003286</a>\n",
    "</p>"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Run analysis\n",
    "# Select model and convert SBML to BoolNet format\n",
    "model_name = models_repo[5]\n",
    "model_path = f\"{bnet_dir}{model_name}.bnet\"\n",
    "sbml2bnet((f\"{sbml_dir}{model_name}.sbml\"), (f\"{bnet_dir}{model_name}.bnet\"))\n",
    "# Load the BoolNet model, extract nodes and count paths\n",
    "model = blv.Load(model_path)\n",
    "nodes = model.Nodes; edges = 104\n",
    "sys.stdout = open(os.devnull, 'w')\n",
    "start_time = time.time()\n",
    "pc = model.CountPaths(nodes, ss_wise = True)\n",
    "end_time = time.time()\n",
    "sys.stdout = sys.__stdout__\n",
    "sim_time = end_time - start_time\n",
    "ls, paths = Report(model, pc) # ls will contain stable state analysis results and paths will contain BooLEVARD's results"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "#Plot Report\n",
    "sim_sum6 = simmulation_summary(model, pc)\n",
    "display(sim_sum6.style.hide(axis = \"index\"))\n",
    "with contextlib.redirect_stdout(io.StringIO()):\n",
    "    plt.figure(figsize=(15, 3)); ls.plot()\n",
    "    plt.figure(figsize=(15, 3)); paths.plot()\n",
    "    plt.figure(figsize=(20, 1)); ls.plot_legends()\n",
    "    plt.figure(figsize=(20, 1)); paths.plot_legends()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "<div style=\"font-size:90%;\">\n",
    "\n",
    "**Figure 6.** Heatmaps showing the Boolean states (top) and the corresponding transduction path counts (bottom), calculated using BooLEVARD, for the stable states reached by the MAPK Cancer Cell Fate Network Boolean Model. The Boolean activation states of the input nodes (*DNA_damage*, *TGFBR_stimulus*, *FGFR3_stimulus*, *EGFR_stimulus*) that drive each stable state are shown to the left of both heatmaps (black = ON, white = OFF). Path counts are shown on a signed logarithmic scale (Log₄ of the number of activating or inhibitory paths). Red indicates a high number of activating paths toward a node; blue indicates inhibitory paths. Rows (stable states) and columns (nodes) have been clustered using Euclidean distance to highlight patterns across conditions and model components.\n",
    "\n",
    "</div>"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "<h5 style=\"margin-top: 00px; margin-bottom: 2px;\" id=\"section-7\"><b>7.- IL-1 Signaling</b><a href=\"#section-0\" style=\"font-size: 12px;\"> [back]</a></h5>\n",
    "<p>\n",
    "\n",
    "This model captures the complex dynamics of the IL-1 signaling mechanisms, which regulate crucial cellular processes such as immune coordination upon infection or injury, mitogenic and pro-proliferative signaling, apoptosis, inhibition, chemotaxis, and angiogenesis, thereby balancing tissue regeneration against invasive growth, tumorigenesis, and metastasis. The network integrates multiple stimulus-response branches, including feedback and feed-forward loops, whose dysregulation is implicated not only in cancer progression, but also in insulin ressitance. The model incorporates extensive literature-curated components and is optimized with high-throughput phosphoproteomic data.\n",
    "<p style=\"font-size:90%; color:gray;\">\n",
    "Ryll A, Samaga R, Schaper F, Alexopoulos LG, Klamt S, et al. (2011).  \n",
    "<i>Large-scale network models of IL-1 and IL-6 signalling and their hepatocellular specification.</i>  \n",
    "Mol Biosyst. 7(12):3253–70.  \n",
    "<a href=\"https://doi.org/10.1039/c1mb05261f\" target=\"_blank\">https://doi.org/10.1039/c1mb05261f</a>\n",
    "</p>\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Run analysis\n",
    "# Select model and convert SBML to BoolNet format\n",
    "model_name = models_repo[6]\n",
    "model_path = f\"{bnet_dir}{model_name}.bnet\"\n",
    "sbml2bnet((f\"{sbml_dir}{model_name}.sbml\"), (f\"{bnet_dir}{model_name}.bnet\"))\n",
    "# Load the BoolNet model, extract nodes and count paths\n",
    "model = blv.Load(model_path)\n",
    "nodes = model.Nodes; edges = 218\n",
    "sys.stdout = open(os.devnull, 'w')\n",
    "start_time = time.time()\n",
    "pc = model.CountPaths(nodes, ss_wise = True)\n",
    "end_time = time.time()\n",
    "sys.stdout = sys.__stdout__\n",
    "sim_time = end_time - start_time\n",
    "ls, paths = Report(model, pc) # ls will contain stable state analysis results and paths will contain BooLEVARD's results"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "#Plot Report\n",
    "sim_sum7 = simmulation_summary(model, pc)\n",
    "display(sim_sum7.style.hide(axis = \"index\"))\n",
    "with contextlib.redirect_stdout(io.StringIO()):\n",
    "    plt.figure(figsize=(15, 3)); ls.plot()\n",
    "    plt.figure(figsize=(15, 3)); paths.plot()\n",
    "    plt.figure(figsize=(20, 1)); ls.plot_legends()\n",
    "    plt.figure(figsize=(20, 1)); paths.plot_legends()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "<h5 style=\"margin-top: 00px; margin-bottom: 2px;\" id=\"section-8\"><b>8.- IL-6 Signaling</b><a href=\"#section-0\" style=\"font-size: 12px;\"> [back]</a></h5>\n",
    "<p>\n",
    "\n",
    "This model captures the complex dynamics of the IL-6 signaling mechanisms, which regulate crucial cellular processes such as immune coordination upon infection or injury, mitogenic and pro-proliferative signaling, apoptosis, inhibition, chemotaxis, and angiogenesis, thereby balancing tissue regeneration against invasive growth, tumorigenesis, and metastasis. The network integrates multiple stimulus-response branches, including feedback and feed-forward loops, whose dysregulation is implicated not only in cancer progression, but also in insulin ressitance. The model incorporates extensive literature-curated components and is optimized with high-throughput phosphoproteomic data.\n",
    "<p style=\"font-size:90%; color:gray;\">\n",
    "Ryll A, Samaga R, Schaper F, Alexopoulos LG, Klamt S, et al. (2011).  \n",
    "<i>Large-scale network models of IL-1 and IL-6 signalling and their hepatocellular specification.</i>  \n",
    "Mol Biosyst. 7(12):3253–70.  \n",
    "<a href=\"https://doi.org/10.1039/c1mb05261f\" target=\"_blank\">https://doi.org/10.1039/c1mb05261f</a>\n",
    "</p>\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Run analysis\n",
    "# Select model and convert SBML to BoolNet format\n",
    "model_name = models_repo[7]\n",
    "model_path = f\"{bnet_dir}{model_name}.bnet\"\n",
    "sbml2bnet((f\"{sbml_dir}{model_name}.sbml\"), (f\"{bnet_dir}{model_name}.bnet\"))\n",
    "# Load the BoolNet model, extract nodes and count paths\n",
    "model = blv.Load(model_path)\n",
    "nodes = model.Nodes; edges = 149\n",
    "sys.stdout = open(os.devnull, 'w')\n",
    "start_time = time.time()\n",
    "pc = model.CountPaths(nodes, ss_wise = True)\n",
    "end_time = time.time()\n",
    "sys.stdout = sys.__stdout__\n",
    "sim_time = end_time - start_time\n",
    "ls, paths = Report(model, pc) # ls will contain stable state analysis results and paths will contain BooLEVARD's results"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "#Plot Report\n",
    "sim_sum8 = simmulation_summary(model, pc)\n",
    "display(sim_sum8.style.hide(axis = \"index\"))\n",
    "with contextlib.redirect_stdout(io.StringIO()):\n",
    "    plt.figure(figsize=(15, 3)); ls.plot()\n",
    "    plt.figure(figsize=(15, 3)); paths.plot()\n",
    "    plt.figure(figsize=(20, 1)); ls.plot_legends()\n",
    "    plt.figure(figsize=(20, 1)); paths.plot_legends()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "<h5 style=\"margin-top: 00px; margin-bottom: 2px;\" id=\"section-9\"><b>9.- Tumor Cell Invasion</b><a href=\"#section-0\" style=\"font-size: 12px;\"> [back]</a></h5>\n",
    "<p>\n",
    "\n",
    "This model captures the complex dynamics of the **early metastatic cascade**, which regulates crucial cellular processes such as local invasion and migration. The network integrates multiple signaling branches relevant in cancer biology, where its dysregulation is associated with metastatic dissemination and patient mortality. Focusing on TGF-beta-driven epithelial-to-mesenchymal transition in lung cancer and validated against transcriptome dynamics and mouse models, the model incorporates key components and interactions derived from extensive literature curation.\n",
    "<p style=\"font-size:90%; color:gray;\">\n",
    "Cohen DPA, Martignetti L, Robine S, Barillot E, Zinovyev A, et al. (2015).  \n",
    "<i>Mathematical Modelling of Molecular Pathways Enabling Tumour Cell Invasion and Migration.</i>  \n",
    "PLOS Computational Biology 11(11): e1004571.  \n",
    "<a href=\"https://doi.org/10.1371/journal.pcbi.1004571\" target=\"_blank\">https://doi.org/10.1371/journal.pcbi.1004571</a>\n",
    "</p>\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Run analysis\n",
    "# Select model and convert SBML to BoolNet format\n",
    "model_name = models_repo[8]\n",
    "model_path = f\"{bnet_dir}{model_name}.bnet\"\n",
    "sbml2bnet((f\"{sbml_dir}{model_name}.sbml\"), (f\"{bnet_dir}{model_name}.bnet\"))\n",
    "# Load the BoolNet model, extract nodes and count paths\n",
    "model = blv.Load(model_path)\n",
    "nodes = model.Nodes; edges = 218\n",
    "sys.stdout = open(os.devnull, 'w')\n",
    "start_time = time.time()\n",
    "pc = model.CountPaths(nodes, ss_wise = True)\n",
    "end_time = time.time()\n",
    "sys.stdout = sys.__stdout__\n",
    "sim_time = end_time - start_time\n",
    "ls, paths = Report(model, pc) # ls will contain stable state analysis results and paths will contain BooLEVARD's results"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "#Plot Report\n",
    "sim_sum9 = simmulation_summary(model, pc)\n",
    "display(sim_sum9.style.hide(axis = \"index\"))\n",
    "with contextlib.redirect_stdout(io.StringIO()):\n",
    "    plt.figure(figsize=(15, 3)); ls.plot()\n",
    "    plt.figure(figsize=(15, 3)); paths.plot()\n",
    "    plt.figure(figsize=(20, 1)); ls.plot_legends()\n",
    "    plt.figure(figsize=(20, 1)); paths.plot_legends()"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.11.2"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
